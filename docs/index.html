<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriately as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="We present AdjointDEIS, an efficient framework for calculating gradients w.r.t. the Probability Flow ODE and diffusion SDE.">
  <meta property="og:title" content="AdjointDEIS: Efficient Gradients for Diffusion Models"/>
  <meta name="og:description" content="We present AdjointDEIS, an efficient framework for calculating gradients w.r.t. the Probability Flow ODE and diffusion SDE.">
  <meta property="og:url" content="https://zblasingame.github.io/AdjointDEIS"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimensions are 1200X630-->
  <!-- <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/> -->


  <meta name="twitter:title" content="AdjointDEIS: Efficient Gradients for Diffusion Models">
  <meta name="twitter:description" content="We present AdjointDEIS, an efficient framework for calculating gradients w.r.t. the Probability Flow ODE and diffusion SDE.">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="AdjointDEIS, Diffusion, Adjoint Sensitivity Methods, ODE Solver, SDE Solver, Guided Generation">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>AdjointDEIS: Efficient Gradients for Diffusion Models</title>
  
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="css/bulma.min.css">
  <link rel="stylesheet" href="css/bulma-carousel.min.css">
  <link rel="stylesheet" href="css/bulma-slider.min.css">
  <link rel="stylesheet" href="css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="js/fontawesome.all.min.js"></script>
  <script src="js/bulma-carousel.min.js"></script>
  <script src="js/bulma-slider.min.js"></script>
  <script src="js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">
              AdjointDEIS: Efficient Gradients for Diffusion Models
            </h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://zblasingame.github.io/" target="_blank">Zander W. Blasingame</a> and </span>
                <span class="author-block">
                  <a href="https://camel.clarkson.edu/members.html" target="_blank">Chen Liu</a></span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Clarkson University</span>
                  </div>

                <div class="is-size-5 publication-authors">
                    <span class="author-block"><b>NeurIPS 2024 (Poster)</b></span>
                  </div>


                  <div class="column has-text-centered">
                    <div class="publication-links">
                      <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://openreview.net/pdf?id=fAlcxvrOEX" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                 <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2405.15020" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>

                      
               <!-- Github link -->
                <span class="link-block">
                  <a href="https://github.com/zblasingame/AdjointDEIS" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                </a>
              </span>

                <span class="link-block">
                  <a href="#BibTeX" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fa fa-quote-left"></i>
                  </span>
                  <span>Cite</span>
                </a>
              </span>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Teaser image-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="assets/overview.png" alt="AdjointDEIS Flow Chart">
      <h2 class="subtitle has-text-centered">
          We propose AdjointDEIS a family of bespoke ODE solvers which solve the continuous adjoint equations for diffusion models.
          Above we show a high level view of AdjointDEIS.
      </h2>
    </div>
  </div>
</section>


<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          The optimization of the latents and parameters of diffusion models with respect to some differentiable metric defined on the output of the model is a challenging and complex problem. The sampling for diffusion models is done by solving either the <i>probability flow</i> ODE or diffusion SDE wherein a neural network approximates the score function allowing a numerical ODE/SDE solver to be used. However, na√Øve backpropagation techniques are memory intensive, requiring the storage of all intermediate states, and face additional complexity in handling the injected noise from the diffusion term of the diffusion SDE. We propose a novel family of bespoke ODE solvers to the continuous adjoint equations for diffusion models, which we call <i>AdjointDEIS</i>. We exploit the unique construction of diffusion SDEs to further simplify the formulation of the continuous adjoint equations using <i>exponential integrators</i>. Moreover, we provide convergence order guarantees for our bespoke solvers. Significantly, we show that continuous adjoint equations for diffusion SDEs actually simplify to a simple ODE. Lastly, we demonstrate the effectiveness of AdjointDEIS for guided generation with an adversarial attack in the form of the face morphing problem.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!--<section class="section hero is-small">-->
  <!--<div class="hero-body">-->
    <!--<div class="container is-max-desktop">-->
      <!--<div class="level-set has-text-justified">-->
        <!--<p>-->
          <!--The face morphing attack attempts to fool a Face Recognition (FR) system by producing a <em>single</em> image which registers a false accept with <em>both</em> original identities. Previous face morphing attacks used landmark-based methods which align and warp the two faces before performing a pixel-wise average between the two faces. Such techniques are prone to considerably artefacts, especially outside the center of the face. Conversely, Generative Adversarial Network (GAN) based morphs produce more realistic looking faces but their performance, but their effectiveness in fooling the FR system leaves much to be desired. DiMs outperform GAN-based morphs; however, they still lag behind landmark-based morphs in terms of fooling an FR system. We propose Greedy-DiM* a family of algorithms which leverage a simple greedy strategy to <em>massively</em> improve the effectiveness of DiM while still retaining the high visual fidelity of DiM.-->
        <!--</p>-->
      <!--</div>-->
      <!--<img class="blend-img-background center-image" src="assets/greedy_dim_example_morph.png" alt="Example morphed image produced by Greedy-DiM">-->
    <!--</div>-->
  <!--</div>-->
<!--</section>-->

  <section class="section hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <h2 class="title is-3">Results</h2>
      <img class="blend-img-background center-image" src="assets/morph_comp.png" alt="AdjointDEIS-1">
      <p>
        We can guide the generative process by using AdjointDEIS. For example we use AdjointDEIS to create high quality face morphs which fool Face Recongition (FR) systems.
      </p>
       <img class="blend-img-background center-image" src="assets/morph_results.png" alt="AdjointDEIS-2M">
      <p>
        AdjointDEIS applied to face morphing achieves SOTA results.
      </p>
    </div>
  </div>
</section>


  <section class="section hero is-small is-light">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <h2 class="title is-3">Method</h2>
      <div class="level-set has-text-justified">
        <p>
            We propose to solve the continous adjoint equations to solve the following optimization problem below.
            We exploit the unique structure of diffusion models to make these numerical solvers <i>efficient</i>.
        </p>
      </div>
        <img class="blend-img-background center-image" src="assets/problem_statement.png" alt="SDE-AdjointDEIS-1">
        <p>
        <strong>Problem Statement</strong> Given a diffusion ODE solve the problem above.
        </p>
        <img class="blend-img-background center-image" src="assets/sde_is_ode.png" alt="SDE-AdjointDEIS-1">
      <p>
        The continuous adjoint equations for diffusion SDEs actually simplify to an ODE!
      </p>
    </div>
  </div>
</section>


  <section class="section hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <h2 class="title is-3">Comparison with Other Methods</h2>
      <img class="blend-img-background center-image" src="assets/comp_adjoint.png" alt="Comparision of methods">
      <div class="level-set has-text-justified">
        <p>
            We can find the gradients for a number of quantities of interest and can find them for both diffusion ODEs and SDEs.
        </p>
      </div>
    </div>
  </div>
</section>


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>
        @inproceedings{blasingame2024adjointdeis,
          title = {Adjoint{DEIS}: Efficient Gradients for Diffusion Models},
          author = {Blasingame, Zander W. and Liu, Chen},
          booktitle = {The Thirty-eighth Annual Conference on Neural Information Processing Systems},
          year = {2024},
          url = {https://openreview.net/forum?id=fAlcxvrOEX},
        }
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <h2 class="title">Acknowledgements</h2>
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>


</body>
</html>
